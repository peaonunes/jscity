(this.webpackJsonpjscity=this.webpackJsonpjscity||[]).push([[0],{126:function(e,t,a){},127:function(e,t,a){"use strict";a.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var n=a(38),r=a.n(n),i=a(0),o=a.n(i),c=a(4),l=a(2),s=a.n(l),u=a(3),m=a(39),d=a.n(m),p={Project:"#757575",File:"#bdbdbd",FunctionDeclaration:"#e41a1c"},E={FILE:"File",PROJECT:"Project",FUNCTION:"FunctionDeclaration",PROGRAM:"Program",BLOCK:"BlockStatement",EXPRESSION:"ExpressionStatement",CALL_EXPRESSION:"CallExpression"};function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f=1;function b(e){var t=0;if(!d()(e.children)){var a=e.children.length;t=a+(a-1)*f}return[(e.cec||1)+t,e.type===E.FUNCTION&&e.loc||1,(e.cec||1)+t]}var h=function(e){var t={},a=e[E.PROJECT],n=[a.id],r=0,i=0,o=0;for(t[a.id]=v({},a,{color:p[a.type],position:[r,i,o]});n.length;){var c=t[n.pop()],l=s()(t,"".concat(c.parent,".position[0]"),0),u=s()(t,"".concat(c.parent,".position[2]"),0);r=c.position[0]+l,o=c.position[2]+u;var m=s()(t,"".concat(c.id,".type"));m===E.FUNCTION?(r=r-c.size[0]/2+f,i=c.position[1]+c.size[1]/2,o=o-c.size[2]/2+f):m===E.FILE?(r=r-c.size[0]/2+f,i=c.position[1]+.5,o=o-c.size[2]/2+f):i=c.position[1]+.5;for(var d=0;d<c.children.length;d++){var g=e[c.children[d]],h=b(g),y=r,O=i+h[1]/2,N=o;g.type===E.FUNCTION&&(y+=h[0]/2,N+=h[2]/2),t[g.id]=v({},g,{color:p[g.type],position:[y,O,N],size:h}),r=r+h[0]+f,o=o+h[2]+f,n.unshift(g.id)}}return t[a.id].size=function(e){return e[E.PROJECT].children.reduce((function(t,a){var n=s()(e,"".concat(a,".size"));return[n[0]+t[0],1,n[2]+t[2]]}),[1,1,1])}(t),t},y=a(40);function O(e){return s()(e,"loc.start.line")}function N(e){return s()(e,"loc.end.line")}function _(e){return s()(e,"id.name","")}function j(e){var t=e.loc,a=t.start.line;return t.end.line-a+1}function S(e,t,a,n){var r=0;switch(e.type){case E.FUNCTION:case E.FILE:var i=function(e,t){return{id:t(),name:_(e),type:e.type,loc:j(e),startLine:O(e),endLine:N(e),children:[]}}(e,n);return a[i.id]=i,a[t].children.push(i.id),a[i.id].parent=t,r=i.type===E.FUNCTION?S(e.body,i.id,a,n):S(e.program,i.id,a,n),a[i.id].cec=r,r;case E.PROGRAM:case E.BLOCK:return e.body.reduce((function(e,r){return e+S(r,t,a,n)}),0);case E.EXPRESSION:return S(e.expression,t,a,n);case E.CALL_EXPRESSION:return 1;default:return 0}}var P=function(e){var t=0,a={},n={id:E.PROJECT,type:E.PROJECT,children:[]};a[n.id]=n,S(y.parse(e,{sourceType:"module",plugins:["jsx"]}),E.PROJECT,a,(function(){return t++}));var r=Object.keys(a).filter((function(e){return a[e].type===E.FILE})),i=r.reduce((function(e,t){return e+(a[t].loc||0)}),0),o=r.reduce((function(e,t){return e+(a[t].cec||0)}),0);return a[n.id].loc=i,a[n.id].cec=o,a},C=a(8),R=a.n(C);var k=function(e){var t=e.autoRotate,a=e.setAutoRotate,n=e.handleUpload,r=Object(i.useState)(!1),l=Object(c.a)(r,2),s=l[0],u=l[1];return o.a.createElement("nav",{className:R.a.navigation},o.a.createElement("h1",null,"JSCity"),o.a.createElement("div",{className:R.a.menu},o.a.createElement("div",{className:R.a.settings},o.a.createElement("div",null,o.a.createElement("label",{htmlFor:"upload"},o.a.createElement("span",{role:"img","aria-label":"upload"},"\ud83d\udcc2")," ","upload file"),o.a.createElement("input",{style:{display:"none"},id:"upload",type:"file",accept:".js,.jsx",onChange:function(e){return n(e.target.files)}})),o.a.createElement("button",{className:R.a.toggle,onClick:function(){return u(!s)}},o.a.createElement("span",{role:"img","aria-label":"open settings"},"\u2699\ufe0f"))),s&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:R.a.divider}),o.a.createElement("div",{className:R.a.options},o.a.createElement("div",{className:R.a.option},o.a.createElement("input",{id:"autoRotate",type:"checkbox",value:t,checked:t,onChange:a}),o.a.createElement("label",{htmlFor:"autoRotate"},"auto rotate"))))))},w=a(5),F=a.n(w);var L=function(e){var t=e.block,a=Object(i.useState)(!0),n=Object(c.a)(a,2),r=n[0],l=n[1];return o.a.createElement("div",{className:F.a.details},o.a.createElement("div",{className:F.a.title},o.a.createElement("strong",{className:F.a.ellipsis,title:s()(t,"name","")},s()(t,"name","")),o.a.createElement("button",{className:F.a.toggle,onClick:function(){return l(!r)}},r&&"\ud83d\ude48",!r&&"\ud83d\udc35")),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:F.a.divider}),o.a.createElement("div",{className:F.a.content},o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"id","")},o.a.createElement("strong",null,"Id: "),s()(t,"id","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"type","")},o.a.createElement("strong",null,"Type: "),o.a.createElement("span",{style:{color:p[s()(t,"type","")]}},"\u25cf"," "),s()(t,"type","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"loc","")},o.a.createElement("strong",null,"Lines of Code: "),s()(t,"loc","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"cec","")},o.a.createElement("strong",null,"Call Expressions: "),s()(t,"cec","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"startLine","")},o.a.createElement("strong",null,"Start line: "),s()(t,"startLine","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"endLine","")},o.a.createElement("strong",null,"End line: "),s()(t,"endLine","")),o.a.createElement("div",{className:F.a.ellipsis,title:s()(t,"parent","")},o.a.createElement("strong",null,"Parent id: "),s()(t,"parent","")))))},I=a(41),x=a.n(I);var B=function(){return o.a.createElement("div",{className:x.a.github},o.a.createElement("a",{href:"https://github.com/peaonunes/jscity",target:"_blank",rel:"noopener noreferrer"},"GitHub"))},D=a(10),T=a(1),M=a(42);Object(D.b)({OrbitControls:M.a});var z=function(e){var t=e.autoRotate,a=Object(i.useRef)(),n=Object(D.d)(),r=n.camera,c=n.gl;return Object(D.c)((function(){return a.current.update()})),o.a.createElement("orbitControls",{autoRotate:t,ref:a,args:[r,c.domElement],enableDamping:!0,dampingFactor:.1,maxZoom:40,minZoom:1,maxPolarAngle:Math.PI/2})},J=a(22),A=a(6);var G=function(e){var t=e.block,a=e.selectedBlock,n=e.onSelect,r=Object(i.useMemo)((function(){return Object(J.a)(T.BoxBufferGeometry,Object(A.a)(t.size))}),[t]),c=s()(a,"id")===t.id?"white":t.color;return o.a.createElement("mesh",{userData:t,position:t.position,onClick:function(e){e.stopPropagation(),n(e.eventObject.userData)},castShadow:!0,receiveShadow:!0},o.a.createElement("meshPhysicalMaterial",{attach:"material",color:c}),o.a.createElement("boxBufferGeometry",{attach:"geometry",args:t.size}),o.a.createElement("lineSegments",null,o.a.createElement("edgesGeometry",{attach:"geometry",args:[r]}),o.a.createElement("lineBasicMaterial",{color:"black",attach:"material"})))},U=function(){return o.a.createElement("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.5,0],receiveShadow:!0},o.a.createElement("planeBufferGeometry",{attach:"geometry",args:[100,100]}),o.a.createElement("meshPhysicalMaterial",{attach:"material",color:"#377eb8"}))};var X=function(e){var t=e.city,a=e.selectedBlock,n=e.onSelect;return o.a.createElement(o.a.Fragment,null,o.a.createElement("group",null,Object.keys(t).map((function(e){return o.a.createElement(G,{key:e,block:t[e],selectedBlock:a,onSelect:n})}))),o.a.createElement(U,null))};var H=function(e){var t=e.city,a=e.selectedBlock,n=e.onSelect,r=e.autoRotate;return o.a.createElement(D.a,{className:"canva",orthographic:!0,camera:{position:[25,25,55],zoom:5,up:[0,1,0],far:1e3},onCreated:function(e){var t=e.gl;t.shadowMap.enabled=!0,t.shadowMap.type=T.PCFSoftShadowMap}},o.a.createElement("ambientLight",{intensity:.75}),o.a.createElement("spotLight",{position:[0,50,100],penumbra:1,castShadow:!0}),o.a.createElement(X,{city:t,selectedBlock:a,onSelect:n}),o.a.createElement(z,{autoRotate:r}))};var W=function(){var e=Object(i.useState)(!0),t=Object(c.a)(e,2),a=t[0],n=t[1],r=Object(i.useState)(null),l=Object(c.a)(r,2),u=l[0],m=l[1],d=Object(i.useState)(),p=Object(c.a)(d,2),E=p[0],g=p[1],v=Object(i.useMemo)((function(){if(!E)return{};var e=P(E);return h(e)}),[E]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(k,{autoRotate:a,setAutoRotate:function(){return n(!a)},handleUpload:function(e){if(null!=e){var t=new FileReader;t.onloadend=function(){g(t.result)},t.readAsText(e[0])}}}),u&&o.a.createElement(L,{block:u}),o.a.createElement(H,{city:v,selectedBlock:u,onSelect:function(e){e.id===s()(u,"id","")?m(null):m(e)},autoRotate:a}),o.a.createElement(B,null))};a(126);r.a.render(o.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},41:function(e,t,a){e.exports={github:"GitHub_github__A_70Z"}},47:function(e,t,a){e.exports=a(127)},5:function(e,t,a){e.exports={details:"Details_details__S35Wv",title:"Details_title__nJ_Go",ellipsis:"Details_ellipsis__237XE",toggle:"Details_toggle__2D3gZ",divider:"Details_divider__29NC1",content:"Details_content__9f6wH"}},8:function(e,t,a){e.exports={navigation:"Navigation_navigation__Weesd",menu:"Navigation_menu__2d1Hw",settings:"Navigation_settings__20t9x",toggle:"Navigation_toggle__1Xtjc",divider:"Navigation_divider__3PBSu",options:"Navigation_options__1gFcg"}}},[[47,1,2]]]);
//# sourceMappingURL=main.44913eaa.chunk.js.map